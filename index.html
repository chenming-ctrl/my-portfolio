<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Chenming LI | Portfolio</title>
    <style>
        :root { --bg-blur: 0px; }
        body, html {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            background-color: #ffffff;
            font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
            -webkit-font-smoothing: antialiased;
            overflow-x: hidden;
        }

        /* 统一导航 */
        nav {
            position: fixed; top: 0; left: 0; width: 100%;
            padding: 40px 60px; display: flex;
            justify-content: space-between; align-items: center;
            z-index: 5000; box-sizing: border-box;
            opacity: 0; transform: translateY(-20px);
            transition: 0.8s cubic-bezier(0.165, 0.84, 0.44, 1);
            pointer-events: none;
        }
        nav.visible { opacity: 1; transform: translateY(0); pointer-events: auto; }
        .nav-logo { font-size: 0.9rem; font-weight: 600; letter-spacing: 2px; cursor: pointer; }
        .nav-links { display: flex; gap: 30px; }
        .nav-links a { 
            text-decoration: none; color: #999; font-size: 0.65rem; 
            text-transform: uppercase; letter-spacing: 1.5px; cursor: pointer; transition: 0.3s;
        }
        .nav-links a:hover { color: #000; }

        /* 画布 */
        #canvas-container {
            position: fixed; width: 100%; height: 100%;
            z-index: 1; transition: filter 1.2s ease;
            filter: blur(var(--bg-blur));
        }

        /* 视图层级控制 */
        .view-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; display: flex; flex-direction: column;
            align-items: center; justify-content: center;
            opacity: 0; visibility: hidden; transition: 0.6s ease;
        }
        .view-layer.active { opacity: 1; visibility: visible; }

        /* 网格系统 */
        .grid-layout {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 40px; width: 85%; max-width: 1200px;
        }
        .card { text-align: center; cursor: pointer; transition: 0.4s; }
        .card:hover { transform: translateY(-10px); }
        .img-wrap { aspect-ratio: 1/1; overflow: hidden; margin-bottom: 15px; background: #f7f7f7; }
        .img-wrap img { width: 100%; height: 100%; object-fit: cover; }
        .label { font-size: 0.6rem; letter-spacing: 2px; text-transform: uppercase; color: #888; }

        /* Level 1: Hero */
        .hero-text { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 5; text-align: center; transition: 0.8s; }
        .hero-text h1 { font-size: 3.5rem; font-weight: 200; letter-spacing: 10px; margin: 0; }
        .hero-text p { font-size: 0.7rem; color: #aaa; margin-top: 25px; letter-spacing: 5px; cursor: pointer; }

        /* Level 4: Behance Style */
        #lvl4 { 
            position: absolute; top: 0; left: 0; width: 100%; min-height: 100vh;
            background: #fff; z-index: 4000; display: none; overflow-y: auto;
        }
        .detail-header { padding: 150px 60px 80px; max-width: 800px; margin: 0 auto; text-align: center; }
        .detail-header h2 { font-size: 2.2rem; font-weight: 200; letter-spacing: 6px; text-transform: uppercase; margin-bottom: 30px;}
        .detail-header p { color: #888; line-height: 2; font-size: 0.85rem; letter-spacing: 0.5px;}
        .detail-images { width: 100%; display: flex; flex-direction: column; align-items: center; gap: 10px; padding-bottom: 100px;}
        .detail-images img { width: 100%; max-width: 1400px; height: auto; }

        .back-hint { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%); font-size: 0.55rem; color: #ddd; letter-spacing: 2px; z-index: 6000; pointer-events: none;}
        .hidden { opacity: 0; pointer-events: none; }

        @media (max-width: 768px) {
            .grid-layout { grid-template-columns: repeat(2, 1fr); gap: 20px; }
            .hero-text h1 { font-size: 2.2rem; }
            .nav-links { display: none; } /* 手机端隐藏复杂导航 */
        }
    </style>
</head>
<body>

<nav id="mainNav">
    <div class="nav-logo" onclick="showLevel(1)">CHENMING</div>
    <div class="nav-links" id="dynamicNav">
        </div>
</nav>

<div class="back-hint" id="escHint">PRESS 'ESC' TO GO BACK</div>

<div id="canvas-container"><canvas id="particleCanvas"></canvas></div>

<div class="hero-text" id="lvl1">
    <h1>CHENMING LI</h1>
    <p onclick="showLevel(2)">Exploration / Design / Research</p>
</div>

<div id="lvl2" class="view-layer">
    <div class="grid-layout" id="dirGrid"></div>
</div>

<div id="lvl3" class="view-layer">
    <div class="grid-layout" id="projGrid"></div>
</div>

<div id="lvl4">
    <div class="detail-header">
        <h2 id="detTitle">Project Title</h2>
        <p id="detDesc">Project description text goes here...</p>
    </div>
    <div class="detail-images" id="detImages"></div>
</div>

<script>
    // --- 核心数据库 ---
    const portfolio = {
        'Architecture': [
            { id: 'a1', title: 'The Void Pavilion', img: 'arch.jpg', desc: 'Space exploration with minimalist structures.', gallery: ['arch.jpg', 'arch.jpg'] },
            { id: 'a2', title: 'Modular Urbanism', img: 'arch.jpg', desc: 'Future of housing.', gallery: ['arch.jpg'] }
        ],
        'Research': [
            { id: 'r1', title: 'Data Flow', img: 'Research.jpg', desc: 'Analyzing urban density.', gallery: ['Research.jpg'] }
        ],
        'Photography': [
            { id: 'p1', title: 'Still Life', img: 'Photo.jpg', desc: 'Nature in frames.', gallery: ['Photo.jpg'] }
        ],
        'Interests': [
            { id: 'i1', title: 'Generative Art', img: 'Interest.jpg', desc: 'Coding for beauty.', gallery: ['Interest.jpg'] }
        ],
        'Ongoing': [
            { id: 'o1', title: 'Thesis Study', img: 'Ongoing.jpg', desc: 'Coming soon.', gallery: ['Ongoing.jpg'] }
        ]
    };

    let currentLvl = 1;
    let currentCat = '';

    // --- 1. 初始化动态导航 (右上角) ---
    function initNav() {
        const navBox = document.getElementById('dynamicNav');
        navBox.innerHTML = Object.keys(portfolio).map(cat => 
            `<a onclick="showLevel(2); setTimeout(()=>showLevel(3, '${cat}'), 100)">${cat}</a>`
        ).join('');
    }

    // --- 2. 核心路由与返回逻辑 ---
    function showLevel(lvl, cat = '') {
        currentLvl = lvl;
        currentCat = cat;

        const layers = ['lvl1', 'lvl2', 'lvl3'];
        layers.forEach(l => document.getElementById(l).classList.remove('active'));
        document.getElementById('lvl1').classList.toggle('hidden', lvl !== 1);
        document.getElementById('escHint').style.opacity = lvl === 1 ? '0' : '1';
        
        const nav = document.getElementById('mainNav');
        nav.classList.toggle('visible', lvl !== 1);
        document.documentElement.style.setProperty('--bg-blur', lvl===1?'0px':lvl===2?'20px':'40px');
        isBlurred = (lvl !== 1);

        if(lvl === 2) {
            const grid = document.getElementById('dirGrid');
            grid.innerHTML = Object.keys(portfolio).map(k => `
                <div class="card" onclick="showLevel(3, '${k}')">
                    <div class="img-wrap"><img src="${portfolio[k][0].img}"></div>
                    <div class="label">${k}</div>
                </div>
            `).join('');
            document.getElementById('lvl2').classList.add('active');
        }
        if(lvl === 3) {
            const grid = document.getElementById('projGrid');
            grid.innerHTML = portfolio[cat].map(p => `
                <div class="card" onclick="openDetail('${cat}', '${p.id}')">
                    <div class="img-wrap"><img src="${p.img}"></div>
                    <div class="label">${p.title}</div>
                </div>
            `).join('');
            document.getElementById('lvl3').classList.add('active');
        }
    }

    // --- 3. 键盘 Esc 监听 ---
    window.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
            if (document.getElementById('lvl4').style.display === 'block') {
                closeDetail();
            } else if (currentLvl === 3) {
                showLevel(2);
            } else if (currentLvl === 2) {
                showLevel(1);
            }
        }
    });

    function openDetail(cat, id) {
        const project = portfolio[cat].find(p => p.id === id);
        document.getElementById('detTitle').innerText = project.title;
        document.getElementById('detDesc').innerText = project.desc;
        document.getElementById('detImages').innerHTML = project.gallery.map(img => `<img src="${img}">`).join('');
        document.getElementById('lvl4').style.display = 'block';
        document.body.style.overflowY = 'auto';
        document.getElementById('escHint').innerText = "PRESS 'ESC' TO CLOSE PROJECT";
    }

    function closeDetail() {
        document.getElementById('lvl4').style.display = 'none';
        document.body.style.overflowY = 'hidden';
        document.getElementById('escHint').innerText = "PRESS 'ESC' TO GO BACK";
    }

    // --- 4. 粒子系统 (胶囊动效) ---
    const canvas = document.getElementById('particleCanvas');
    const ctx = canvas.getContext('2d');
    let particles = [], isBlurred = false;
    let m = { x: 0, y: 0, smX: 0, smY: 0, vx: 0, vy: 0 };
    window.addEventListener('mousemove', e => { m.x = e.clientX; m.y = e.clientY; });

    class P {
        constructor() {
            this.x = Math.random()*canvas.width; this.y = Math.random()*canvas.height;
            this.bs = Math.random()*1.5 + 1; this.s = this.bs;
            this.c = ['#4285F4', '#34A853', '#FBBC05', '#EA4335', '#9b59b6'][Math.floor(Math.random()*5)];
            this.v = {x:(Math.random()-0.5)*0.3, y:(Math.random()-0.5)*0.3};
            this.st = 1; this.a = 0;
        }
        update() {
            this.x+=this.v.x; this.y+=this.v.y;
            if(this.x<0||this.x>canvas.width)this.v.x*=-1;
            if(this.y<0||this.y>canvas.height)this.v.y*=-1;
            let d = Math.hypot(m.smX-this.x, m.smY-this.y);
            if(d < 150) {
                let f = (150-d)/150;
                this.s = this.bs + f*20;
                let spd = Math.hypot(m.vx, m.vy);
                this.st = 1 + (spd * 0.15);
                this.a = Math.atan2(m.vy, m.vx);
            } else {
                this.s += (this.bs-this.s)*0.1;
                this.st += (1-this.st)*0.1;
            }
            this.draw();
        }
        draw() {
            ctx.save(); ctx.translate(this.x, this.y); ctx.rotate(this.a);
            ctx.beginPath(); ctx.ellipse(0,0,this.s*this.st, this.s, 0,0, Math.PI*2);
            ctx.fillStyle = this.c; ctx.globalAlpha = isBlurred?0.4:0.8; ctx.fill(); ctx.restore();
        }
    }

    function init() {
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        particles = Array.from({length: 120}, () => new P());
        initNav();
    }
    function animate() {
        ctx.clearRect(0,0,canvas.width, canvas.height);
        let px = m.smX; let py = m.smY;
        m.smX += (m.x - m.smX) * 0.1; m.smY += (m.y - m.smY) * 0.1;
        m.vx = m.smX - px; m.vy = m.smY - py;
        particles.forEach(p => p.update());
        requestAnimationFrame(animate);
    }
    init(); animate();
    window.addEventListener('resize', init);
</script>
</body>
</html>